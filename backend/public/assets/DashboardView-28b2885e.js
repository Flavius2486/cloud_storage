import{g as ee,_ as V,r as x,o as P,c as z,h as g,i as N,b as h,t as $,p as X,f as K,a as L,F as Z,D as te,j as ae,M as re,k as U,e as G}from"./index-c64f7efd.js";import{D as se,M as ne}from"./dataWrapper-86a84303.js";import{f as ie}from"./fetchData-5dffe008.js";var J={exports:{}};(function(u){(function(){var o=function(d){if(!(this instanceof o))return new o(d);if(this.version=1,this.support=typeof File<"u"&&typeof Blob<"u"&&typeof FileList<"u"&&(!!Blob.prototype.webkitSlice||!!Blob.prototype.mozSlice||!!Blob.prototype.slice||!1),!this.support)return!1;var s=this;s.files=[],s.defaults={chunkSize:1048576,forceChunkSize:!1,simultaneousUploads:3,fileParameterName:"file",chunkNumberParameterName:"resumableChunkNumber",chunkSizeParameterName:"resumableChunkSize",currentChunkSizeParameterName:"resumableCurrentChunkSize",totalSizeParameterName:"resumableTotalSize",typeParameterName:"resumableType",identifierParameterName:"resumableIdentifier",fileNameParameterName:"resumableFilename",relativePathParameterName:"resumableRelativePath",totalChunksParameterName:"resumableTotalChunks",throttleProgressCallbacks:.5,query:{},headers:{},preprocess:null,method:"multipart",uploadMethod:"POST",testMethod:"GET",prioritizeFirstAndLastChunk:!1,target:"/",testTarget:null,parameterNamespace:"",testChunks:!0,generateUniqueIdentifier:null,getTarget:null,maxChunkRetries:100,chunkRetryInterval:void 0,permanentErrors:[400,404,415,500,501],maxFiles:void 0,withCredentials:!1,xhrTimeout:0,clearInput:!0,chunkFormat:"blob",setChunkTypeFromFile:!1,maxFilesErrorCallback:function(t,r){var n=s.getOpt("maxFiles");alert("Please upload no more than "+n+" file"+(n===1?"":"s")+" at a time.")},minFileSize:1,minFileSizeErrorCallback:function(t,r){alert(t.fileName||t.name+" is too small, please upload files larger than "+l.formatSize(s.getOpt("minFileSize"))+".")},maxFileSize:void 0,maxFileSizeErrorCallback:function(t,r){alert(t.fileName||t.name+" is too large, please upload files less than "+l.formatSize(s.getOpt("maxFileSize"))+".")},fileType:[],fileTypeErrorCallback:function(t,r){alert(t.fileName||t.name+" has type not allowed, please upload files of type "+s.getOpt("fileType")+".")}},s.opts=d||{},s.getOpt=function(t){var r=this;if(t instanceof Array){var n={};return l.each(t,function(a){n[a]=r.getOpt(a)}),n}if(r instanceof B){if(typeof r.opts[t]<"u")return r.opts[t];r=r.fileObj}if(r instanceof I){if(typeof r.opts[t]<"u")return r.opts[t];r=r.resumableObj}if(r instanceof o)return typeof r.opts[t]<"u"?r.opts[t]:r.defaults[t]},s.events=[],s.on=function(t,r){s.events.push(t.toLowerCase(),r)},s.fire=function(){for(var t=[],r=0;r<arguments.length;r++)t.push(arguments[r]);for(var n=t[0].toLowerCase(),r=0;r<=s.events.length;r+=2)s.events[r]==n&&s.events[r+1].apply(s,t.slice(1)),s.events[r]=="catchall"&&s.events[r+1].apply(null,t);n=="fileerror"&&s.fire("error",t[2],t[1]),n=="fileprogress"&&s.fire("progress")};var l={stopEvent:function(t){t.stopPropagation(),t.preventDefault()},each:function(t,r){if(typeof t.length<"u"){for(var n=0;n<t.length;n++)if(r(t[n])===!1)return}else for(n in t)if(r(n,t[n])===!1)return},generateUniqueIdentifier:function(t,r){var n=s.getOpt("generateUniqueIdentifier");if(typeof n=="function")return n(t,r);var a=t.webkitRelativePath||t.fileName||t.name,e=t.size;return e+"-"+a.replace(/[^0-9a-zA-Z_-]/img,"")},contains:function(t,r){var n=!1;return l.each(t,function(a){return a==r?(n=!0,!1):!0}),n},formatSize:function(t){return t<1024?t+" bytes":t<1024*1024?(t/1024).toFixed(0)+" KB":t<1024*1024*1024?(t/1024/1024).toFixed(1)+" MB":(t/1024/1024/1024).toFixed(1)+" GB"},getTarget:function(t,r){var n=s.getOpt("target");if(t==="test"&&s.getOpt("testTarget")&&(n=s.getOpt("testTarget")==="/"?s.getOpt("target"):s.getOpt("testTarget")),typeof n=="function")return n(r);var a=n.indexOf("?")<0?"?":"&",e=r.join("&");return n+a+e}},p=function(t){l.stopEvent(t),t.dataTransfer&&t.dataTransfer.items?A(t.dataTransfer.items,t):t.dataTransfer&&t.dataTransfer.files&&A(t.dataTransfer.files,t)},y=function(t){t.preventDefault()};function S(t,r,n,a){var e;if(t.isFile)return t.file(function(m){m.relativePath=r+m.name,n.push(m),a()});if(t.isDirectory?e=t:t instanceof File&&n.push(t),typeof t.webkitGetAsEntry=="function"&&(e=t.webkitGetAsEntry()),e&&e.isDirectory)return q(e,r+e.name+"/",n,a);typeof t.getAsFile=="function"&&(t=t.getAsFile(),t instanceof File&&(t.relativePath=r+t.name,n.push(t))),a()}function j(t,r){if(!t||t.length===0)return r();t[0](function(){j(t.slice(1),r)})}function q(t,r,n,a){var e=t.createReader();e.readEntries(function(m){if(!m.length)return a();j(m.map(function(i){return S.bind(null,i,r,n)}),a)})}function A(t,r){if(t.length){s.fire("beforeAdd");var n=[];j(Array.prototype.map.call(t,function(a){return S.bind(null,a,"",n)}),function(){n.length&&T(n,r)})}}var T=function(t,r){var n=0,a=s.getOpt(["maxFiles","minFileSize","maxFileSize","maxFilesErrorCallback","minFileSizeErrorCallback","maxFileSizeErrorCallback","fileType","fileTypeErrorCallback"]);if(typeof a.maxFiles<"u"&&a.maxFiles<t.length+s.files.length)if(a.maxFiles===1&&s.files.length===1&&t.length===1)s.removeFile(s.files[0]);else return a.maxFilesErrorCallback(t,n++),!1;var e=[],m=[],i=t.length,f=function(){if(!--i){if(!e.length&&!m.length)return;window.setTimeout(function(){s.fire("filesAdded",e,m)},0)}};l.each(t,function(c){var k=c.name;if(a.fileType.length>0){var _=!1;for(var F in a.fileType){var b="."+a.fileType[F];if(k.toLowerCase().indexOf(b.toLowerCase(),k.length-b.length)!==-1){_=!0;break}}if(!_)return a.fileTypeErrorCallback(c,n++),!1}if(typeof a.minFileSize<"u"&&c.size<a.minFileSize)return a.minFileSizeErrorCallback(c,n++),!1;if(typeof a.maxFileSize<"u"&&c.size>a.maxFileSize)return a.maxFileSizeErrorCallback(c,n++),!1;function E(w){s.getFromUniqueIdentifier(w)?m.push(c):function(){c.uniqueIdentifier=w;var D=new I(s,c,w);s.files.push(D),e.push(D),D.container=typeof r<"u"?r.srcElement:null,window.setTimeout(function(){s.fire("fileAdded",D,r)},0)}(),f()}var C=l.generateUniqueIdentifier(c,r);C&&typeof C.then=="function"?C.then(function(w){E(w)},function(){f()}):E(C)})};function I(t,r,n){var a=this;a.opts={},a.getOpt=t.getOpt,a._prevProgress=0,a.resumableObj=t,a.file=r,a.fileName=r.fileName||r.name,a.size=r.size,a.relativePath=r.relativePath||r.webkitRelativePath||a.fileName,a.uniqueIdentifier=n,a._pause=!1,a.container="";var e=n!==void 0,m=function(i,f){switch(i){case"progress":a.resumableObj.fire("fileProgress",a,f);break;case"error":a.abort(),e=!0,a.chunks=[],a.resumableObj.fire("fileError",a,f);break;case"success":if(e)return;a.resumableObj.fire("fileProgress",a),a.isComplete()&&a.resumableObj.fire("fileSuccess",a,f);break;case"retry":a.resumableObj.fire("fileRetry",a);break}};return a.chunks=[],a.abort=function(){var i=0;l.each(a.chunks,function(f){f.status()=="uploading"&&(f.abort(),i++)}),i>0&&a.resumableObj.fire("fileProgress",a)},a.cancel=function(){var i=a.chunks;a.chunks=[],l.each(i,function(f){f.status()=="uploading"&&(f.abort(),a.resumableObj.uploadNextChunk())}),a.resumableObj.removeFile(a),a.resumableObj.fire("fileProgress",a)},a.retry=function(){a.bootstrap();var i=!1;a.resumableObj.on("chunkingComplete",function(){i||a.resumableObj.upload(),i=!0})},a.bootstrap=function(){a.abort(),e=!1,a.chunks=[],a._prevProgress=0;for(var i=a.getOpt("forceChunkSize")?Math.ceil:Math.floor,f=Math.max(i(a.file.size/a.getOpt("chunkSize")),1),c=0;c<f;c++)(function(k){window.setTimeout(function(){a.chunks.push(new B(a.resumableObj,a,k,m)),a.resumableObj.fire("chunkingProgress",a,k/f)},0)})(c);window.setTimeout(function(){a.resumableObj.fire("chunkingComplete",a)},0)},a.progress=function(){if(e)return 1;var i=0,f=!1;return l.each(a.chunks,function(c){c.status()=="error"&&(f=!0),i+=c.progress(!0)}),i=f||i>.99999?1:i,i=Math.max(a._prevProgress,i),a._prevProgress=i,i},a.isUploading=function(){var i=!1;return l.each(a.chunks,function(f){if(f.status()=="uploading")return i=!0,!1}),i},a.isComplete=function(){var i=!1;return l.each(a.chunks,function(f){var c=f.status();if(c=="pending"||c=="uploading"||f.preprocessState===1)return i=!0,!1}),!i},a.pause=function(i){typeof i>"u"?a._pause=!a._pause:a._pause=i},a.isPaused=function(){return a._pause},a.resumableObj.fire("chunkingStart",a),a.bootstrap(),this}function B(t,r,n,a){var e=this;e.opts={},e.getOpt=t.getOpt,e.resumableObj=t,e.fileObj=r,e.fileObjSize=r.size,e.fileObjType=r.file.type,e.offset=n,e.callback=a,e.lastProgressCallback=new Date,e.tested=!1,e.retries=0,e.pendingRetry=!1,e.preprocessState=0;var m=e.getOpt("chunkSize");return e.loaded=0,e.startByte=e.offset*m,e.endByte=Math.min(e.fileObjSize,(e.offset+1)*m),e.fileObjSize-e.endByte<m&&!e.getOpt("forceChunkSize")&&(e.endByte=e.fileObjSize),e.xhr=null,e.test=function(){e.xhr=new XMLHttpRequest;var i=function(F){e.tested=!0;var b=e.status();b=="success"?(e.callback(b,e.message()),e.resumableObj.uploadNextChunk()):e.send()};e.xhr.addEventListener("load",i,!1),e.xhr.addEventListener("error",i,!1),e.xhr.addEventListener("timeout",i,!1);var f=[],c=e.getOpt("parameterNamespace"),k=e.getOpt("query");typeof k=="function"&&(k=k(e.fileObj,e)),l.each(k,function(F,b){f.push([encodeURIComponent(c+F),encodeURIComponent(b)].join("="))}),f=f.concat([["chunkNumberParameterName",e.offset+1],["chunkSizeParameterName",e.getOpt("chunkSize")],["currentChunkSizeParameterName",e.endByte-e.startByte],["totalSizeParameterName",e.fileObjSize],["typeParameterName",e.fileObjType],["identifierParameterName",e.fileObj.uniqueIdentifier],["fileNameParameterName",e.fileObj.fileName],["relativePathParameterName",e.fileObj.relativePath],["totalChunksParameterName",e.fileObj.chunks.length]].filter(function(F){return e.getOpt(F[0])}).map(function(F){return[c+e.getOpt(F[0]),encodeURIComponent(F[1])].join("=")})),e.xhr.open(e.getOpt("testMethod"),l.getTarget("test",f)),e.xhr.timeout=e.getOpt("xhrTimeout"),e.xhr.withCredentials=e.getOpt("withCredentials");var _=e.getOpt("headers");typeof _=="function"&&(_=_(e.fileObj,e)),l.each(_,function(F,b){e.xhr.setRequestHeader(F,b)}),e.xhr.send(null)},e.preprocessFinished=function(){e.preprocessState=2,e.send()},e.send=function(){var i=e.getOpt("preprocess");if(typeof i=="function")switch(e.preprocessState){case 0:e.preprocessState=1,i(e);return;case 1:return}if(e.getOpt("testChunks")&&!e.tested){e.test();return}e.xhr=new XMLHttpRequest,e.xhr.upload.addEventListener("progress",function(v){new Date-e.lastProgressCallback>e.getOpt("throttleProgressCallbacks")*1e3&&(e.callback("progress"),e.lastProgressCallback=new Date),e.loaded=v.loaded||0},!1),e.loaded=0,e.pendingRetry=!1,e.callback("progress");var f=function(v){var O=e.status();if(O=="success"||O=="error")e.callback(O,e.message()),e.resumableObj.uploadNextChunk();else{e.callback("retry",e.message()),e.abort(),e.retries++;var W=e.getOpt("chunkRetryInterval");W!==void 0?(e.pendingRetry=!0,setTimeout(e.send,W)):e.send()}};e.xhr.addEventListener("load",f,!1),e.xhr.addEventListener("error",f,!1),e.xhr.addEventListener("timeout",f,!1);var c=[["chunkNumberParameterName",e.offset+1],["chunkSizeParameterName",e.getOpt("chunkSize")],["currentChunkSizeParameterName",e.endByte-e.startByte],["totalSizeParameterName",e.fileObjSize],["typeParameterName",e.fileObjType],["identifierParameterName",e.fileObj.uniqueIdentifier],["fileNameParameterName",e.fileObj.fileName],["relativePathParameterName",e.fileObj.relativePath],["totalChunksParameterName",e.fileObj.chunks.length]].filter(function(v){return e.getOpt(v[0])}).reduce(function(v,O){return v[e.getOpt(O[0])]=O[1],v},{}),k=e.getOpt("query");typeof k=="function"&&(k=k(e.fileObj,e)),l.each(k,function(v,O){c[v]=O});var _=e.fileObj.file.slice?"slice":e.fileObj.file.mozSlice?"mozSlice":e.fileObj.file.webkitSlice?"webkitSlice":"slice",F=e.fileObj.file[_](e.startByte,e.endByte,e.getOpt("setChunkTypeFromFile")?e.fileObj.file.type:""),b=null,E=[],C=e.getOpt("parameterNamespace");if(e.getOpt("method")==="octet")b=F,l.each(c,function(v,O){E.push([encodeURIComponent(C+v),encodeURIComponent(O)].join("="))});else if(b=new FormData,l.each(c,function(v,O){b.append(C+v,O),E.push([encodeURIComponent(C+v),encodeURIComponent(O)].join("="))}),e.getOpt("chunkFormat")=="blob")b.append(C+e.getOpt("fileParameterName"),F,e.fileObj.fileName);else if(e.getOpt("chunkFormat")=="base64"){var w=new FileReader;w.onload=function(v){b.append(C+e.getOpt("fileParameterName"),w.result),e.xhr.send(b)},w.readAsDataURL(F)}var D=l.getTarget("upload",E),Y=e.getOpt("uploadMethod");e.xhr.open(Y,D),e.getOpt("method")==="octet"&&e.xhr.setRequestHeader("Content-Type","application/octet-stream"),e.xhr.timeout=e.getOpt("xhrTimeout"),e.xhr.withCredentials=e.getOpt("withCredentials");var R=e.getOpt("headers");typeof R=="function"&&(R=R(e.fileObj,e)),l.each(R,function(v,O){e.xhr.setRequestHeader(v,O)}),e.getOpt("chunkFormat")=="blob"&&e.xhr.send(b)},e.abort=function(){e.xhr&&e.xhr.abort(),e.xhr=null},e.status=function(){return e.pendingRetry?"uploading":e.xhr?e.xhr.readyState<4?"uploading":e.xhr.status==200||e.xhr.status==201?"success":l.contains(e.getOpt("permanentErrors"),e.xhr.status)||e.retries>=e.getOpt("maxChunkRetries")?"error":(e.abort(),"pending"):"pending"},e.message=function(){return e.xhr?e.xhr.responseText:""},e.progress=function(i){typeof i>"u"&&(i=!1);var f=i?(e.endByte-e.startByte)/e.fileObjSize:1;if(e.pendingRetry)return 0;(!e.xhr||!e.xhr.status)&&(f*=.95);var c=e.status();switch(c){case"success":case"error":return 1*f;case"pending":return 0*f;default:return e.loaded/(e.endByte-e.startByte)*f}},this}return s.uploadNextChunk=function(){var t=!1;if(s.getOpt("prioritizeFirstAndLastChunk")&&(l.each(s.files,function(n){if(n.chunks.length&&n.chunks[0].status()=="pending"&&n.chunks[0].preprocessState===0)return n.chunks[0].send(),t=!0,!1;if(n.chunks.length>1&&n.chunks[n.chunks.length-1].status()=="pending"&&n.chunks[n.chunks.length-1].preprocessState===0)return n.chunks[n.chunks.length-1].send(),t=!0,!1}),t)||(l.each(s.files,function(n){if(n.isPaused()===!1&&l.each(n.chunks,function(a){if(a.status()=="pending"&&a.preprocessState===0)return a.send(),t=!0,!1}),t)return!1}),t))return!0;var r=!1;return l.each(s.files,function(n){if(!n.isComplete())return r=!0,!1}),r||s.fire("complete"),!1},s.assignBrowse=function(t,r){typeof t.length>"u"&&(t=[t]),l.each(t,function(n){var a;n.tagName==="INPUT"&&n.type==="file"?a=n:(a=document.createElement("input"),a.setAttribute("type","file"),a.style.display="none",n.addEventListener("click",function(){a.style.opacity=0,a.style.display="block",a.focus(),a.click(),a.style.display="none"},!1),n.appendChild(a));var e=s.getOpt("maxFiles");typeof e>"u"||e!=1?a.setAttribute("multiple","multiple"):a.removeAttribute("multiple"),r?a.setAttribute("webkitdirectory","webkitdirectory"):a.removeAttribute("webkitdirectory");var m=s.getOpt("fileType");typeof m<"u"&&m.length>=1?a.setAttribute("accept",m.map(function(i){return"."+i}).join(",")):a.removeAttribute("accept"),a.addEventListener("change",function(i){T(i.target.files,i);var f=s.getOpt("clearInput");f&&(i.target.value="")},!1)})},s.assignDrop=function(t){typeof t.length>"u"&&(t=[t]),l.each(t,function(r){r.addEventListener("dragover",y,!1),r.addEventListener("dragenter",y,!1),r.addEventListener("drop",p,!1)})},s.unAssignDrop=function(t){typeof t.length>"u"&&(t=[t]),l.each(t,function(r){r.removeEventListener("dragover",y),r.removeEventListener("dragenter",y),r.removeEventListener("drop",p)})},s.isUploading=function(){var t=!1;return l.each(s.files,function(r){if(r.isUploading())return t=!0,!1}),t},s.upload=function(){if(!s.isUploading()){s.fire("uploadStart");for(var t=1;t<=s.getOpt("simultaneousUploads");t++)s.uploadNextChunk()}},s.pause=function(){l.each(s.files,function(t){t.abort()}),s.fire("pause")},s.cancel=function(){s.fire("beforeCancel");for(var t=s.files.length-1;t>=0;t--)s.files[t].cancel();s.fire("cancel")},s.progress=function(){var t=0,r=0;return l.each(s.files,function(n){t+=n.progress()*n.size,r+=n.size}),r>0?t/r:0},s.addFile=function(t,r){T([t],r)},s.addFiles=function(t,r){T(t,r)},s.removeFile=function(t){for(var r=s.files.length-1;r>=0;r--)s.files[r]===t&&s.files.splice(r,1)},s.getFromUniqueIdentifier=function(t){var r=!1;return l.each(s.files,function(n){n.uniqueIdentifier==t&&(r=n)}),r},s.getSize=function(){var t=0;return l.each(s.files,function(r){t+=r.size}),t},s.handleDropEvent=function(t){p(t)},s.handleChangeEvent=function(t){T(t.target.files,t),t.target.value=""},s.updateQuery=function(t){s.opts.query=t},this};u.exports=o})()})(J);var oe=J.exports;const le=ee(oe);const ue={name:"file-status",emits:["abort-uploading"],props:{status:{type:String,default:null},numberOfFilesToUpload:{type:Number,default:0},numberOfUploadedFiles:{type:Number,default:0}},data(){return{showFileStatus:!0}},methods:{hideFileStatus(){this.showFileStatus=!1}},watch:{status(){this.showFileStatus=!0}}},M=u=>(X("data-v-fcf3137c"),u=u(),K(),u),fe={key:0,class:"file-status-container"},de={key:0,class:"status"},ce=M(()=>h("p",null,"An error has occurred...",-1)),pe={key:1,class:"status"},he={key:2,class:"status"},me=M(()=>h("p",null,"Aborted",-1)),ge={key:3,class:"status"},be=M(()=>h("div",{class:"loader icon"},null,-1)),ve={class:"status-text"},ye={key:4,class:"status"},ke=M(()=>h("div",{class:"loader icon"},null,-1)),Fe=M(()=>h("p",{class:"status-text"},"Aborting",-1)),Oe=[ke,Fe];function Se(u,o,d,s,l,p){const y=x("fa");return d.status&&l.showFileStatus?(P(),z("div",fe,[d.status=="error"?(P(),z("div",de,[g(y,{icon:["fas","circle-exclamation"],style:{color:"#cf1717"},class:"status-icon"}),ce])):N("",!0),d.status=="success"?(P(),z("div",pe,[g(y,{icon:["far","circle-check"],style:{color:"#16ac2f"},class:"status-icon"}),h("p",null,"Files uploaded successfully ("+$(d.numberOfFilesToUpload)+")",1)])):N("",!0),d.status=="aborted"?(P(),z("div",he,[g(y,{icon:["far","circle-check"],style:{color:"#16ac2f"},class:"status-icon"}),me])):N("",!0),d.status=="uploading"?(P(),z("div",ge,[be,h("p",ve,$(d.numberOfUploadedFiles)+" out of "+$(d.numberOfFilesToUpload)+" files uploaded ",1)])):N("",!0),d.status=="aborting"?(P(),z("div",ye,Oe)):N("",!0),h("div",{class:"xmark-container",onClick:o[0]||(o[0]=(...S)=>p.hideFileStatus&&p.hideFileStatus(...S))},[g(y,{icon:["fas","xmark"],class:"xmark"})]),d.status=="uploading"?(P(),z("div",{key:5,class:"abort-btn",onClick:o[1]||(o[1]=S=>u.$emit("abort-uploading"))}," Abort ")):N("",!0)])):N("",!0)}const Ce=V(ue,[["render",Se],["__scopeId","data-v-fcf3137c"]]),xe={name:"create-private-folder",emits:["hide-modal","update-data"],data(){return{selectedPrivateFolderPath:"",availablePaths:[]}},methods:{hideError(){const u=document.querySelector(".private-folder-name-input");u.style.borderColor="#CDCDD6"},getAvailablePaths(){L.post("http://localhost:3002/api/fetch-data",{dataCategory:"folders"},{withCredentials:!0}).then(u=>{this.availablePaths=u.data.dataArray})},createFolder(){const u=document.querySelector(".private-folder-name-input"),o=document.querySelector(".private-folder-path-selector");let d=u.value;d.length===0||this.selectedPrivateFolderPath.length===0?(d.length===0&&(u.style.borderColor="red"),this.selectedPrivateFolderPath.length===0&&(o.style.borderColor="red")):L.post("http://localhost:3002/api/create-folder",{isPublic:!1,name:d,uniquePath:this.selectedPrivateFolderPath.unique_path,frontendPath:this.selectedPrivateFolderPath.frontend_path.slice(1,-1)},{withCredentials:!0}).then(s=>{this.$emit("update-data"),this.$emit("hide-modal",s.data)}).catch(s=>{console.log(s)})}},watch:{selectedPrivateFolderPath(u){u.length!==0&&(document.querySelector(".private-folder-path-selector").style.borderColor="transparent")}}},_e=h("p",{class:"modal-subtitle"},"Name",-1),we=h("p",{class:"modal-subtitle"},"Location",-1);function Pe(u,o,d,s,l,p){const y=x("v-select");return P(),z(Z,null,[h("div",null,[_e,h("input",{type:"text",class:"private-folder-name-input input-field",onChange:o[0]||(o[0]=S=>p.hideError())},null,32)]),h("div",null,[we,g(y,{options:l.availablePaths,class:"private-folder-path-selector selector",label:"frontend_path",value:"unique_path",modelValue:l.selectedPrivateFolderPath,"onUpdate:modelValue":o[1]||(o[1]=S=>l.selectedPrivateFolderPath=S)},null,8,["options","modelValue"])]),h("div",{class:"create-private-folder-btn modal-btn",onClick:o[2]||(o[2]=S=>p.createFolder())}," Create ")],64)}const ze=V(xe,[["render",Pe]]),Q=()=>{L.post("http://localhost:3002/api/reset-data",{},{withCredentials:!0}).then(()=>{}).catch(u=>{throw u})};const Te={components:{Dropdown:te,DropdownOption:ae,DataWrapper:se,FilesActionStatus:Ce,Modal:ne,CreatePrivateFolder:ze,MessageBox:re},data(){return{data:[],resumable:null,filesStatus:null,filesToUpload:0,uploadedFiles:0,lastFileAdedIndex:0,uploadedFilesFromGroup:0,filesGroup:[],input:"file"}},created(){this.updateData()},mounted(){this.resumable=new le({target:"http://localhost:3002/api/upload",testChunks:!1,chunkSize:10*1024*1024,simultaneousUploads:1,maxChunkRetries:5,maxFileSize:1/0,minFileSize:0,withCredentials:!0}),this.resumable.on("fileError",u=>{console.error("Error uploading "+u.file.name),this.filesStatus="error"}),this.resumable.on("fileSuccess",()=>{this.updateData(),this.uploadedFiles++,this.uploadedFiles===this.filesToUpload&&(this.filesStatus="success",this.resumable.files=[],this.filesGroup=[],this.lastFileAdedIndex=0,this.uploadedFilesFromGroup=0,Q()),this.filesStatus!=="error"&&(this.uploadedFilesFromGroup++,this.uploadedFilesFromGroup===this.filesGroup.length&&(this.uploadedFilesFromGroup=0,this.filesGroup=[],this.resumable.files=[],this.uploadFiles!==this.filesToUpload&&this.uploadFiles()))}),this.resumable.on("fileProgress",()=>{this.filesStatus="uploading"})},methods:{abortUploading(){this.reinitializeVariablesFileStatus(),this.resumable.cancel(),this.filesStatus="aborting",L.post("http://localhost:3002/api/delete-chunks",{},{withCredentials:!0}).then(()=>{this.filesStatus="aborted"}).catch(()=>{this.filesStatus="error"})},updateData(){ie("dashboard").then(u=>{this.data=u}).catch(u=>{console.error("Error:",u)})},hideModalTrigger(u){this.$refs.Modal.hideModal(),this.$refs.MessageBox.showMessage(u.message)},uploadFilesBtn(){if(this.filesStatus!=="uploading"){const u=document.querySelector(".upload-file input");this.reinitializeVariablesFileStatus(),u.click()}else this.$refs.MessageBox.showMessage("Uploading in progress. Please wait...")},uploadFoldersBtn(){if(this.filesStatus!=="uploading"){const u=document.querySelector(".upload-folder input");this.reinitializeVariablesFileStatus(),u.click()}else this.$refs.MessageBox.showMessage("Uploading in progress. Please wait...")},reinitializeVariablesFileStatus(){this.filesStatus=null,this.uploadedFiles=0,this.filesToUpload=0},uploadFiles(){let u=0;const o=Array.from(document.querySelector(`.upload-${this.input} input`).files);this.filesToUpload=o.length;for(let d=this.lastFileAdedIndex;d<o.length;d++){if(u+=Number(o[d].size),(u/Math.pow(1024,3)).toFixed(0)+Number(this.$store.state.usedMemory)>=Number(this.$store.state.freeMemory)){this.abortUploading(),this.$refs.MessageBox.showMessage("Disk memory is almost full. Aborting..."),Q();break}if(this.filesGroup.push(o[d]),u/1048576>=100||d+1==o.length){this.lastFileAdedIndex=d+1;break}}this.resumable.addFiles(this.filesGroup),this.resumable.opts.headers={NumberOfFiles:this.filesToUpload},setTimeout(()=>{this.resumable.upload()},500)},showModal(u){const o=document.querySelectorAll(".modal"),d=document.querySelector(".overlay");o.forEach(s=>{u.target.classList.contains(s.classList[0])&&(s.classList.remove("hidden"),d.classList.remove("hidden"))})},showDropdown(u){this.$refs.dataWrapper.cancelfilesSelection(),document.querySelectorAll(".dropdown").forEach(d=>{d.classList.add("hidden"),u.target.classList.contains(d.classList[0])&&setTimeout(()=>{d.classList.remove("hidden")},100)})}}},H=u=>(X("data-v-0c7fc7a6"),u=u(),K(),u),Ne={class:"dashboard-view__header"},je=H(()=>h("h1",null,"Dashboard",-1)),Ee={class:"dashboard-view__header--buttons"},De=H(()=>h("p",{class:"dropdown-upload"},"Upload",-1)),Ue=H(()=>h("p",{class:"dropdown-create-folder"},"Create",-1));function Me(u,o,d,s,l,p){const y=x("fa"),S=x("DropdownOption"),j=x("Dropdown"),q=x("DataWrapper"),A=x("FilesActionStatus"),T=x("MessageBox"),I=x("CreatePrivateFolder"),B=x("Modal");return P(),z(Z,null,[h("header",Ne,[je,h("div",Ee,[h("div",{class:"dashboard-view__upload-asets--button dropdown-upload",onClick:o[0]||(o[0]=t=>p.showDropdown(t))},[g(y,{icon:["fas","upload"],class:"dropdown-upload"}),De,g(y,{icon:["fas","chevron-down"],class:"dashboard-view__header--buttons__down-arrow--icon dropdown-upload"})]),g(j,{customClass:"dropdown-upload",style:{marginTop:"38px",marginLeft:"0"}},{default:U(()=>[g(S,{class:"upload-file",icon:["fas","file"],type:"file",onClick:o[1]||(o[1]=t=>p.uploadFilesBtn(t)),onChange:o[2]||(o[2]=t=>{l.input="file",p.uploadFiles(t)})},{default:U(()=>[G("File")]),_:1}),g(S,{class:"upload-folder",icon:["fas","folder"],type:"folder",onClick:o[3]||(o[3]=t=>p.uploadFoldersBtn(t)),onChange:o[4]||(o[4]=t=>{l.input="folder",p.uploadFiles(t)})},{default:U(()=>[G("Folder")]),_:1})]),_:1}),h("div",{class:"dashboard-view__create-folder--button dropdown-create-folder",onClick:o[5]||(o[5]=t=>p.showDropdown(t))},[g(y,{icon:["fas","plus"],class:"dropdown-create-folder"}),Ue,g(y,{icon:["fas","chevron-down"],class:"dashboard-view__header--buttons__down-arrow--icon dropdown-create-folder"})]),g(j,{customClass:"dropdown-create-folder",style:{marginTop:"38px",marginLeft:"140px"}},{default:U(()=>[g(S,{icon:["fas","folder-plus"],customClass:"modal-create-folder",onClick:o[6]||(o[6]=t=>(p.showModal(t),u.$refs.createFolderModal.getAvailablePaths()))},{default:U(()=>[G("Folder")]),_:1})]),_:1})])]),g(q,{data:l.data,page:"dashboard",ref:"dataWrapper",onUpdateData:o[7]||(o[7]=t=>p.updateData())},null,8,["data"]),g(A,{status:l.filesStatus,numberOfFilesToUpload:l.filesToUpload,numberOfUploadedFiles:l.uploadedFiles,onAbortUploading:o[8]||(o[8]=t=>p.abortUploading()),ref:"filesActionStatusRef"},null,8,["status","numberOfFilesToUpload","numberOfUploadedFiles"]),g(T,{ref:"MessageBox",style:{marginLeft:"15px",bottom:"20px"}},null,512),g(B,{title:"Create folder",customClass:"modal-create-folder",ref:"Modal"},{default:U(()=>[g(I,{onHideModal:p.hideModalTrigger,onUpdateData:o[9]||(o[9]=t=>p.updateData()),ref:"createFolderModal"},null,8,["onHideModal"])]),_:1},512)],64)}const Re=V(Te,[["render",Me],["__scopeId","data-v-0c7fc7a6"]]);export{Re as default};
